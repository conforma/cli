
[TestValidateImageSignatureWithCertificates - 1]
[]signature.EntitySignature{
    {
        KeyID:       "6add046e38418d021a562c6a8633d5eca7379595",
        Signature:   "signature",
        Certificate: "-----BEGIN CERTIFICATE-----\nMIIG2TCCBl+gAwIBAgIUdtQgx3Mj6A3T0X7Oh8bS1nNABTEwCgYIKoZIzj0EAwMw\nNzEVMBMGA1UEChMMc2lnc3RvcmUuZGV2MR4wHAYDVQQDExVzaWdzdG9yZS1pbnRl\ncm1lZGlhdGUwHhcNMjMwNjA3MDMxNDEyWhcNMjMwNjA3MDMyNDEyWjAAMFkwEwYH\nKoZIzj0CAQYIKoZIzj0DAQcDQgAEz6tsPZHx7njElmbGbMYxKiYneuofINbOE8Tg\n1gkyQcckWyu1xA/Fs0O1SpPkn/KJYLJ3J5ziqgd1EguuCqK3Z6OCBX4wggV6MA4G\nA1UdDwEB/wQEAwIHgDATBgNVHSUEDDAKBggrBgEFBQcDAzAdBgNVHQ4EFgQUat0E\nbjhBjQIaVixqhjPV7Kc3lZUwHwYDVR0jBBgwFoAU39Ppz1YkEZb5qNjpKFWixi4Y\nZD8waAYDVR0RAQH/BF4wXIZaaHR0cHM6Ly9naXRodWIuY29tL2NoYWluZ3VhcmQt\naW1hZ2VzL2ltYWdlcy8uZ2l0aHViL3dvcmtmbG93cy9yZWxlYXNlLnlhbWxAcmVm\ncy9oZWFkcy9tYWluMDkGCisGAQQBg78wAQEEK2h0dHBzOi8vdG9rZW4uYWN0aW9u\ncy5naXRodWJ1c2VyY29udGVudC5jb20wEgYKKwYBBAGDvzABAgQEcHVzaDA2Bgor\nBgEEAYO/MAEDBChlMWRjZGY3MGJlMzI2YTQ5NDI5NTc1NDYyMmZlMzQ2MzE2MDA1\nMzFhMCwGCisGAQQBg78wAQQEHi5naXRodWIvd29ya2Zsb3dzL3JlbGVhc2UueWFt\nbDAmBgorBgEEAYO/MAEFBBhjaGFpbmd1YXJkLWltYWdlcy9pbWFnZXMwHQYKKwYB\nBAGDvzABBgQPcmVmcy9oZWFkcy9tYWluMDsGCisGAQQBg78wAQgELQwraHR0cHM6\nLy90b2tlbi5hY3Rpb25zLmdpdGh1YnVzZXJjb250ZW50LmNvbTBqBgorBgEEAYO/\nMAEJBFwMWmh0dHBzOi8vZ2l0aHViLmNvbS9jaGFpbmd1YXJkLWltYWdlcy9pbWFn\nZXMvLmdpdGh1Yi93b3JrZmxvd3MvcmVsZWFzZS55YW1sQHJlZnMvaGVhZHMvbWFp\nbjA4BgorBgEEAYO/MAEKBCoMKGUxZGNkZjcwYmUzMjZhNDk0Mjk1NzU0NjIyZmUz\nNDYzMTYwMDUzMWEwHQYKKwYBBAGDvzABCwQPDA1naXRodWItaG9zdGVkMDsGCisG\nAQQBg78wAQwELQwraHR0cHM6Ly9naXRodWIuY29tL2NoYWluZ3VhcmQtaW1hZ2Vz\nL2ltYWdlczA4BgorBgEEAYO/MAENBCoMKGUxZGNkZjcwYmUzMjZhNDk0Mjk1NzU0\nNjIyZmUzNDYzMTYwMDUzMWEwHwYKKwYBBAGDvzABDgQRDA9yZWZzL2hlYWRzL21h\naW4wGQYKKwYBBAGDvzABDwQLDAk1NjM1MTA5NTIwNAYKKwYBBAGDvzABEAQmDCRo\ndHRwczovL2dpdGh1Yi5jb20vY2hhaW5ndWFyZC1pbWFnZXMwGQYKKwYBBAGDvzAB\nEQQLDAkxMTMxOTg1NDUwagYKKwYBBAGDvzABEgRcDFpodHRwczovL2dpdGh1Yi5j\nb20vY2hhaW5ndWFyZC1pbWFnZXMvaW1hZ2VzLy5naXRodWIvd29ya2Zsb3dzL3Jl\nbGVhc2UueWFtbEByZWZzL2hlYWRzL21haW4wOAYKKwYBBAGDvzABEwQqDChlMWRj\nZGY3MGJlMzI2YTQ5NDI5NTc1NDYyMmZlMzQ2MzE2MDA1MzFhMBQGCisGAQQBg78w\nARQEBgwEcHVzaDBeBgorBgEEAYO/MAEVBFAMTmh0dHBzOi8vZ2l0aHViLmNvbS9j\naGFpbmd1YXJkLWltYWdlcy9pbWFnZXMvYWN0aW9ucy9ydW5zLzUxOTU1MDc2MzYv\nYXR0ZW1wdHMvMTCBigYKKwYBBAHWeQIEAgR8BHoAeAB2AN09MGrGxxEyYxkeHJln\nNwKiSl643jyt/4eKcoAvKe6OAAABiJPZADAAAAQDAEcwRQIgdHXB0QGS/GWkBnY1\nAZXSwb6/tbnnaVeWzde3t0fkkRMCIQC0bwdhWep548Cp4LzBPgGD0eioadqQdJHe\nXtVXBkD1dDAKBggqhkjOPQQDAwNoADBlAjBPpXDUSaAk5D6T1Eaqh+TRSQXr6rqV\nYxAJb/NgDbq8tTVLKustJDu2V9TQcpSzuKICMQDt0EAHmTISmKC8H3dciTrySh2l\nuS2rfl+L2AFS6DxAmVTBR3dlbrxQsUxshBWyH5s=\n-----END CERTIFICATE-----\n",
        Chain:       {"-----BEGIN CERTIFICATE-----\nMIICGjCCAaGgAwIBAgIUALnViVfnU0brJasmRkHrn/UnfaQwCgYIKoZIzj0EAwMw\nKjEVMBMGA1UEChMMc2lnc3RvcmUuZGV2MREwDwYDVQQDEwhzaWdzdG9yZTAeFw0y\nMjA0MTMyMDA2MTVaFw0zMTEwMDUxMzU2NThaMDcxFTATBgNVBAoTDHNpZ3N0b3Jl\nLmRldjEeMBwGA1UEAxMVc2lnc3RvcmUtaW50ZXJtZWRpYXRlMHYwEAYHKoZIzj0C\nAQYFK4EEACIDYgAE8RVS/ysH+NOvuDZyPIZtilgUF9NlarYpAd9HP1vBBH1U5CV7\n7LSS7s0ZiH4nE7Hv7ptS6LvvR/STk798LVgMzLlJ4HeIfF3tHSaexLcYpSASr1kS\n0N/RgBJz/9jWCiXno3sweTAOBgNVHQ8BAf8EBAMCAQYwEwYDVR0lBAwwCgYIKwYB\nBQUHAwMwEgYDVR0TAQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQU39Ppz1YkEZb5qNjp\nKFWixi4YZD8wHwYDVR0jBBgwFoAUWMAeX5FFpWapesyQoZMi0CrFxfowCgYIKoZI\nzj0EAwMDZwAwZAIwPCsQK4DYiZYDPIaDi5HFKnfxXx6ASSVmERfsynYBiX2X6SJR\nnZU84/9DZdnFvvxmAjBOt6QpBlc4J/0DxvkTCqpclvziL6BCCPnjdlIB3Pu3BxsP\nmygUY7Ii2zbdCdliiow=\n-----END CERTIFICATE-----\n", "-----BEGIN CERTIFICATE-----\nMIIB9zCCAXygAwIBAgIUALZNAPFdxHPwjeDloDwyYChAO/4wCgYIKoZIzj0EAwMw\nKjEVMBMGA1UEChMMc2lnc3RvcmUuZGV2MREwDwYDVQQDEwhzaWdzdG9yZTAeFw0y\nMTEwMDcxMzU2NTlaFw0zMTEwMDUxMzU2NThaMCoxFTATBgNVBAoTDHNpZ3N0b3Jl\nLmRldjERMA8GA1UEAxMIc2lnc3RvcmUwdjAQBgcqhkjOPQIBBgUrgQQAIgNiAAT7\nXeFT4rb3PQGwS4IajtLk3/OlnpgangaBclYpsYBr5i+4ynB07ceb3LP0OIOZdxex\nX69c5iVuyJRQ+Hz05yi+UF3uBWAlHpiS5sh0+H2GHE7SXrk1EC5m1Tr19L9gg92j\nYzBhMA4GA1UdDwEB/wQEAwIBBjAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBRY\nwB5fkUWlZql6zJChkyLQKsXF+jAfBgNVHSMEGDAWgBRYwB5fkUWlZql6zJChkyLQ\nKsXF+jAKBggqhkjOPQQDAwNpADBmAjEAj1nHeXZp+13NWBNa+EDsDP8G1WWg1tCM\nWP/WHPqpaVo0jhsweNFZgSs0eE7wYI4qAjEA2WB9ot98sIkoF3vZYdd3/VtWB5b9\nTNMea7Ix/stJ5TfcLLeABLE4BNJOsQ4vnBHJ\n-----END CERTIFICATE-----\n"},
        Metadata:    {"Fulcio Build Config Digest":"e1dcdf70be326a494295754622fe34631600531a", "Fulcio Build Config URI":"https://github.com/chainguard-images/images/.github/workflows/release.yaml@refs/heads/main", "Fulcio Build Signer Digest":"e1dcdf70be326a494295754622fe34631600531a", "Fulcio Build Signer URI":"https://github.com/chainguard-images/images/.github/workflows/release.yaml@refs/heads/main", "Fulcio Build Trigger":"push", "Fulcio GitHub Workflow Name":".github/workflows/release.yaml", "Fulcio GitHub Workflow Ref":"refs/heads/main", "Fulcio GitHub Workflow Repository":"chainguard-images/images", "Fulcio GitHub Workflow SHA":"e1dcdf70be326a494295754622fe34631600531a", "Fulcio GitHub Workflow Trigger":"push", "Fulcio Issuer":"https://token.actions.githubusercontent.com", "Fulcio Issuer (V2)":"https://token.actions.githubusercontent.com", "Fulcio Run Invocation URI":"https://github.com/chainguard-images/images/actions/runs/5195507636/attempts/1", "Fulcio Runner Environment":"github-hosted", "Fulcio Source Repository Digest":"e1dcdf70be326a494295754622fe34631600531a", "Fulcio Source Repository Identifier":"563510952", "Fulcio Source Repository Owner Identifier":"113198545", "Fulcio Source Repository Owner URI":"https://github.com/chainguard-images", "Fulcio Source Repository Ref":"refs/heads/main", "Fulcio Source Repository URI":"https://github.com/chainguard-images/images", "Issuer":"CN=sigstore-intermediate,O=sigstore.dev", "Not After":"2023-06-07T03:24:12Z", "Not Before":"2023-06-07T03:14:12Z", "Serial Number":"76d420c77323e80dd3d17ece87c6d2d673400531", "Subject Alternative Name":"URIs:https://github.com/chainguard-images/images/.github/workflows/release.yaml@refs/heads/main"},
    },
}
---

[TestWriteInputFile/single_attestations - 1]
{
 "attestations": [
  {
   "statement": {
    "_type": "https://in-toto.io/Statement/v0.1",
    "predicate": {
     "buildType": "https://tekton.dev/attestations/chains/pipelinerun@v2",
     "builder": {
      "id": ""
     },
     "invocation": {
      "configSource": {}
     }
    },
    "predicateType": "https://slsa.dev/provenance/v0.2",
    "subject": null
   }
  }
 ],
 "image": {
  "ref": "registry.io/repository/image:tag",
  "source": {}
 }
}
---

[TestWriteInputFile/multiple_attestations - 1]
{
 "attestations": [
  {
   "statement": {
    "_type": "https://in-toto.io/Statement/v0.1",
    "predicate": {
     "buildType": "https://tekton.dev/attestations/chains/pipelinerun@v2",
     "builder": {
      "id": ""
     },
     "invocation": {
      "configSource": {}
     }
    },
    "predicateType": "https://slsa.dev/provenance/v0.2",
    "subject": null
   }
  },
  {
   "statement": {
    "_type": "https://in-toto.io/Statement/v0.1",
    "predicate": {
     "buildType": "https://tekton.dev/attestations/chains/pipelinerun@v2",
     "builder": {
      "id": ""
     },
     "invocation": {
      "configSource": {}
     }
    },
    "predicateType": "https://slsa.dev/provenance/v0.2",
    "subject": null
   }
  }
 ],
 "image": {
  "ref": "registry.io/repository/image:tag",
  "source": {}
 }
}
---

[TestWriteInputFile/image_signatures - 1]
{
 "attestations": [
  {
   "statement": {
    "_type": "https://in-toto.io/Statement/v0.1",
    "predicate": {
     "buildType": "https://tekton.dev/attestations/chains/pipelinerun@v2",
     "builder": {
      "id": ""
     },
     "invocation": {
      "configSource": {}
     }
    },
    "predicateType": "https://slsa.dev/provenance/v0.2",
    "subject": null
   }
  }
 ],
 "image": {
  "ref": "registry.io/repository/image:tag",
  "signatures": [
   {
    "chain": [
     "certificate1",
     "certificate2"
    ],
    "keyid": "keyId1",
    "sig": "signature1"
   },
   {
    "keyid": "keyId2",
    "sig": "signature2"
   }
  ],
  "source": {}
 }
}
---

[TestWriteInputFile/image_config - 1]
{
 "attestations": null,
 "image": {
  "config": {
   "Labels": {
    "io.k8s.display-name": "Test Image"
   }
  },
  "ref": "registry.io/repository/image:tag",
  "source": {}
 }
}
---

[TestWriteInputFile/parent_image_config - 1]
{
 "attestations": null,
 "image": {
  "parent": {
   "config": {
    "Labels": {
     "io.k8s.display-name": "Base Image"
    }
   },
   "ref": "registry.io/repository/image/parent:tag"
  },
  "ref": "registry.io/repository/image:tag",
  "source": {}
 }
}
---

[TestWriteInputFile/attestation_with_signature - 1]
{
 "attestations": [
  {
   "signatures": [
    {
     "certificate": "certificate",
     "chain": [
      "a",
      "b",
      "c"
     ],
     "keyid": "keyId",
     "metadata": {
      "k1": "v1",
      "k2": "v2"
     },
     "sig": "signature"
    }
   ],
   "statement": {
    "_type": "https://in-toto.io/Statement/v0.1",
    "predicate": {
     "buildType": "https://tekton.dev/attestations/chains/pipelinerun@v2",
     "builder": {
      "id": ""
     },
     "invocation": {
      "configSource": {}
     }
    },
    "predicateType": "https://slsa.dev/provenance/v0.2",
    "subject": null
   }
  }
 ],
 "image": {
  "ref": "registry.io/repository/image:tag",
  "source": {}
 }
}
---

[TestWriteInputFileMultipleAttestations - 1]
{
 "attestations": [
  {
   "statement": {
    "_type": "https://in-toto.io/Statement/v0.1",
    "predicate": {
     "buildType": "https://tekton.dev/attestations/chains/pipelinerun@v2",
     "builder": {
      "id": ""
     },
     "invocation": {
      "configSource": {}
     }
    },
    "predicateType": "https://slsa.dev/provenance/v0.2",
    "subject": null
   }
  }
 ],
 "image": {
  "ref": "registry.io/repository/image:tag",
  "source": {}
 }
}
---

[TestWriteInputFile/component_with_source - 1]
{
 "attestations": null,
 "image": {
  "ref": "registry.io/repository/image:tag",
  "source": {
   "git": {
    "revision": "main",
    "url": "git.local/repository"
   }
  }
 }
}
---
